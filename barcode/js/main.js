(function(){"use strict";function e(e){for(var a=0;a!==e.length;++a){var t=e[a],n=document.createElement("option");if(n.value=t.id,"video"===t.kind){var o=""==t.facing?"unknown":t.facing;n.text=t.label||"camera "+(_.length+1)+" (facing: "+o+")",_.appendChild(n)}}}var a=$("#qr-canvas"),t=$(".scanner-laser"),n=$("#play"),o=$("#scanned-img"),i=$("#scanned-QR"),d=$("#save"),r=$("#stop"),l=$("#stopAll"),s=$("#contrast"),c=$("#contrast-value"),p=$("#zoom"),u=$("#zoom-value"),g=$("#brightness"),f=$("#brightness-value"),C=$("#threshold"),m=$("#threshold-value"),v=$("#sharpness"),h=$("#sharpness-value"),b=$("#grayscale"),W=$("#grayscale-value");$('[data-toggle="tooltip"]').tooltip(),t.css("opacity",.5),n.click(function(){"undefined"==typeof a.data().plugin_WebCodeCam?(a.WebCodeCam({videoSource:{id:$("select#cameraId").val(),maxWidth:640,maxHeight:480},autoBrightnessValue:120,resultFunction:function(e,a){o.attr("src",a),i.text(e),t.fadeOut(150,function(){t.fadeIn(150)})},getUserMediaError:function(){alert("Sorry, the browser you are using doesn't support getUserMedia")},cameraError:function(e){var a,t="Error detected with the following parameters:\n";for(a in e)t+=a+": "+e[a]+"\n";alert(t)}}),i.text("Scanning ..."),d.removeClass("disabled"),r.click(function(){d.addClass("disabled"),i.text("Stopped"),a.data().plugin_WebCodeCam.cameraStop()}),l.click(function(){d.addClass("disabled"),i.text("Stopped"),a.data().plugin_WebCodeCam.cameraStopAll()})):(d.removeClass("disabled"),i.text("Scanning ..."),a.data().plugin_WebCodeCam.cameraPlay())}),d.click(function(){if("undefined"!=typeof a.data().plugin_WebCodeCam){var e=a.data().plugin_WebCodeCam.getLastImageSrc();o.attr("src",e)}}),Page.changeZoom=function(e){if("undefined"!=typeof a.data().plugin_WebCodeCam){var t="undefined"!=typeof e?parseFloat(e.toPrecision(2)):p.val()/10;u.text(u.text().split(":")[0]+": "+t.toString()),a.data().plugin_WebCodeCam.options.zoom=parseFloat(t),"undefined"!=typeof e&&p.val(10*e)}},Page.changeContrast=function(){if("undefined"!=typeof a.data().plugin_WebCodeCam){var e=s.val();c.text(c.text().split(":")[0]+": "+e.toString()),a.data().plugin_WebCodeCam.options.contrast=parseFloat(e)}},Page.changeBrightness=function(){if("undefined"!=typeof a.data().plugin_WebCodeCam){var e=g.val();f.text(f.text().split(":")[0]+": "+e.toString()),a.data().plugin_WebCodeCam.options.brightness=parseFloat(e)}},Page.changeThreshold=function(){if("undefined"!=typeof a.data().plugin_WebCodeCam){var e=C.val();m.text(m.text().split(":")[0]+": "+e.toString()),a.data().plugin_WebCodeCam.options.threshold=parseFloat(e)}},Page.changeSharpness=function(){if("undefined"!=typeof a.data().plugin_WebCodeCam){var e=v.prop("checked");e?(h.text(h.text().split(":")[0]+": on"),a.data().plugin_WebCodeCam.options.sharpness=[0,-1,0,-1,5,-1,0,-1,0]):(h.text(h.text().split(":")[0]+": off"),a.data().plugin_WebCodeCam.options.sharpness=[])}},Page.changeGrayscale=function(){if("undefined"!=typeof a.data().plugin_WebCodeCam){var e=b.prop("checked");e?(W.text(W.text().split(":")[0]+": on"),a.data().plugin_WebCodeCam.options.grayScale=!0):(W.text(W.text().split(":")[0]+": off"),a.data().plugin_WebCodeCam.options.grayScale=!1)}};var y=setInterval(function(){var e;try{e=a.data().plugin_WebCodeCam.optimalZoom()}catch(t){e=0}0!=e&&(Page.changeZoom(e),clearInterval(y))},500);if("undefined"!=typeof MediaStreamTrack.getSources){var _=document.querySelector("select#cameraId");$(_).change(function(){"undefined"!=typeof a.data().plugin_WebCodeCam&&(a.data().plugin_WebCodeCam.options.videoSource.id=$(this).val(),a.data().plugin_WebCodeCam.cameraStop(),a.data().plugin_WebCodeCam.cameraPlay(!1))}),MediaStreamTrack.getSources(e)}else document.querySelector("select#cameraId").remove()}).call(window.Page=window.Page||{});